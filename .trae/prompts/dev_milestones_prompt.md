# 开发里程碑与确定性任务的AI Prompt（Vite + FastAPI 推荐栈）

目标：让AI在本仓库内按照技术设计文档执行开发，分里程碑推进，每个里程碑包含明确任务与可验证的检查点，确保输出可运行、可测试、与约束一致。

上下文：
- 技术设计文档路径：PRD_SPEC/TECHNICAL_DESIGN.md
- 推荐栈与一致性决策：见 1.1（Vite + React Router + FastAPI）
- AI必须遵循项目技能约束：.trae/skills/ai-dev-rules/SKILL.md

通用执行原则：
- 任何网络请求统一走 frontend/src/lib/api.ts 提供的Fetcher；禁止直接fetch/axios
- 查询键、方法命名、UI白名单、Shared组件拼装、错误与API契约、i18n键命名须严格遵循技术设计文档
- 对每个变更提供最小验证：单元测试或运行示例；必要时提供可预览链接
- 输出中必须包含：任务清单、变更摘要、文件路径与链接、验证结果说明

里程碑划分（按 9.1）：
- 里程碑一：基础架构搭建（2周）
  - 任务：
    - 初始化前端：按 4.1a 目录与入口（src/main.tsx、router.tsx）、统一Fetcher（4.7.1）、i18n初始化（4.3.2 Vite方案）
    - 初始化UI最小集：按 10.6~10.6.3 的 Shared 组件最小可用集
    - 初始化后端：按 5.1a 目录（app/main.py、api/v1/*、schemas、services、db/session.py），统一错误（7.3）、OpenAPI开启（6.0）
  - 检查点（Definition of Done）：
    - 前端能启动并显示基础页面骨架；所有示例数据请求走统一Fetcher与规范查询键
    - i18n键命名符合 10.6.4；存在至少一个页面与组件的中英文切换示例
    - 后端能启动并返回 /openapi.json；统一错误结构与认证中间件契约（6.0.5）已接入
    - 给出最小单元测试或组件Story（组件级），以及前后端启动说明

- 里程碑二：核心功能开发（4周）
  - 任务（按 5.3 与 6.2）：
    - 学生信息插件：GET/PUT /plugins/student/profile（前后端联通、表单受控、校验与错误提示）
    - 学校插件：列表/详情/分数线接口与页面（筛选、分页、缓存、空/错/载态）
    - 目标学校插件：列表/新增/删除与页面操作（确认对话框、toast提示）
    - 模考记录插件：列表/新增/更新/删除与统计（表格与图表、缓存与失效策略）
  - 检查点：
    - 每个资源的接口响应与错误结构严格符合 6.0；查询键与方法命名符合 4.7.2
    - 页面拼装仅使用 Shared + 白名单组件；ARIA与data-testid具备
    - React Query 缓存与失效按 4.5；列表含分页与空态；错误统一展示
    - 覆盖最小单元测试（前后端），并附运行说明

- 里程碑三：评估系统开发（3周）
  - 任务：
    - Python评估模型（plugins/eval/python/*）与后端路由（/evaluation/*）
    - 前端评估结果页面与图表展示（透明度说明与模型参数）
  - 检查点：
    - 概率计算过程与输入/输出在文档中可解释（10.2），页面展示原始数据与计算依据
    - 性能与缓存策略合理（React Query + 请求幂等策略 4.7.1/6.0.6）
    - 单元测试覆盖模型与路由；错误类型映射一致（7.3）

- 里程碑四：优化与测试（2周）
  - 任务：
    - 前后端错误监控（Sentry可选）、无障碍与可访问性补强、国际化键覆盖率、Storybook示例
    - 统一日志结构与关键路径诊断
  - 检查点：
    - ErrorBoundary与统一错误显示组件就位；常见错误路径有重试入口
    - i18n键规范完整；组件提供最小Story与测试选择器
    - 关键接口具备负载与速率限制策略说明

- 里程碑五：部署与上线（1周）
  - 任务：
    - 传统服务器或云平台部署；Nginx反代与SSL；环境变量与密钥管理
    - OpenAPI文档发布与SDK生成；基础监控上线
  - 检查点：
    - 架构图与部署步骤清晰；后端与前端分别可独立上线且联通
    - 错误告警与访问日志可用；接口限流与安全头生效

AI响应格式（每次执行）：
- 背景与目标：引用技术设计文档相关章节与链接
- 里程碑与任务：列出本次要完成的任务与预期产出
- 变更清单：文件路径、修改摘要、关键实现点
- 验证与结果：测试/预览/运行说明；覆盖到DoD检查点
- 后续建议：若有风险或待补项，给出明确下一步

必须遵循的确定性约束（摘自文档）：
- 统一Fetcher与查询键：[4.7.1](../../PRD_SPEC/TECHNICAL_DESIGN.md#L458-L504)、[4.7.2](../../PRD_SPEC/TECHNICAL_DESIGN.md#L505-L517)
- 缓存策略：[4.5](../../PRD_SPEC/TECHNICAL_DESIGN.md#L343-L397)
- UI白名单与Shared组件集：[10.6~10.6.3](../../PRD_SPEC/TECHNICAL_DESIGN.md#L1557-L1694)
- i18n键规范：[10.6.4](../../PRD_SPEC/TECHNICAL_DESIGN.md#L1695-L1699)
- API契约与错误结构：[6.0~6.0.5](../../PRD_SPEC/TECHNICAL_DESIGN.md#L820-L890)、错误码字典[6.0.1](../../PRD_SPEC/TECHNICAL_DESIGN.md#L852-L862)
- 统一异常处理与认证保护：[7.3](../../PRD_SPEC/TECHNICAL_DESIGN.md#L1045-L1158)、[4.4](../../PRD_SPEC/TECHNICAL_DESIGN.md#L299-L342)
- 架构一致性决策（推荐栈）：[1.1](../../PRD_SPEC/TECHNICAL_DESIGN.md#L6-L12)

示例开场Prompt（复制粘贴使用）：
```
你是本仓库的资深AI开发伙伴。请基于 PRD_SPEC/TECHNICAL_DESIGN.md 与项目技能约束（.trae/skills/ai-dev-rules/SKILL.md），完成“里程碑一：基础架构搭建”的任务，并达到对应检查点（DoD）。要求：
1) 前端：初始化 Vite 项目结构与路由入口；接入统一Fetcher（src/lib/api.ts）；初始化 react-i18next；初始化shadcn，通过shadcn搭建Shared组件最小集页面骨架，首页实现一个Shared组件的完整演示页面。
2) 后端：按 FastAPI 推荐目录创建 app/main.py 与 api/v1/auth、schools 等空路由；开启OpenAPI；接入统一异常结构；准备数据库连接
3) 输出格式：给出任务清单、变更清单（含文件路径）、关键实现点、验证与结果（如何运行与测试）、后续建议
4) 严格遵循：统一Fetcher与查询键、UI白名单、i18n键规范、API契约与错误结构；不得引入未批准依赖；避免泄露敏感信息
开始执行，并确保每个检查点都有可验证说明。
```

