# 学校详情模块需求变更文档

## 变更基本信息
- **变更类型**: 需求迭代
- **模块名称**: 学校详情
- **变更日期**: 2026-02-03
- **变更编号**: CR-2026-02-03-学校详情-v1.2

## 变更背景
学校详情模块需要进行功能迭代，恢复NavBar功能，优化现有卡片样式，并添加基于学生画像的学校卡片。

## 变更内容

### 1. 恢复NavBar
- **现状**: 学校详情页面没有NavBar
- **变更**: 恢复原来的NavBar，以及对应的功能

### 2. 新增基于学生画像的学校卡片
- **现状**: 学生画像卡片下方没有学校卡片
- **变更**: 
  - 在学生画像下面，添加基于画像计算的"学校卡片"
  - 内容和样式跟目标页"学校"列表一致
  - 不需要操作按钮，其他保持一致

### 3. "最近一年招生情况" 样式优化
- **现状**: 2列布局，数字文本字体较大且加粗突出
- **变更**: 
  - 改为3列2行布局
  - 数字文本字体调小
  - 不需要加粗突出

### 4. "录取分数线"样式优化
- **现状**: 2列布局，顺序为"到区"、"到校"、"统招"，数字文本字体较大且加粗突出
- **变更**: 
  - 改为3列1行布局
  - 顺序改成"统招"、"到区"、"到校"
  - 数字文本字体调小
  - 不需要加粗突出

## 技术设计方案

### 1. 前端组件修改

#### 1.1 恢复NavBar
- **文件**: `src/features/schools/SchoolDetailPage.tsx`
- **修改内容**: 
  - 导入NavBar组件
  - 在页面顶部添加NavBar，包含返回按钮功能

#### 1.2 新增基于学生画像的学校卡片
- **文件**: `src/features/schools/components/SchoolProfileSection.tsx`
- **修改内容**: 
  - 在学生画像下方添加学校卡片
  - 卡片内容和样式参考目标页的学校列表卡片
  - 移除操作按钮，保留其他内容

#### 1.3 优化"最近一年招生情况"样式
- **文件**: `src/features/schools/components/SchoolEnrollmentSection.tsx`
- **修改内容**: 
  - 修改DataCardGrid的布局为3列
  - 调整DataCard的样式，减小字体大小，移除加粗样式

#### 1.4 优化"录取分数线"样式
- **文件**: `src/features/schools/components/SchoolScoresSection.tsx`
- **修改内容**: 
  - 修改DataCardGrid的布局为3列
  - 调整DataCard的顺序为"统招"、"到区"、"到校"
  - 调整DataCard的样式，减小字体大小，移除加粗样式

### 2. 数据结构

#### 2.1 学校卡片数据结构
- **数据来源**: 基于学生画像计算的推荐学校
- **数据结构**:
  ```typescript
  interface SchoolCard {
    id: string;
    name: string;
    district: string;
    type: string;
    accommodation?: string;
    stats: {
      probability?: number;
      quotaAutonomous?: number;
      quotaToDistrict?: number;
      quotaToSchool?: number;
      scoreUnified?: number;
      scoreToDistrict?: number;
      scoreToSchool?: number;
    };
  }
  ```

## API设计

### 1. 现有API
- **接口路径**: `/api/schools/<school_id>/detail`
- **请求方法**: GET
- **响应数据结构**: 保持不变

### 2. 学校卡片数据获取
- **数据来源**: 复用现有的学校列表API
- **接口路径**: `/api/schools`
- **请求方法**: GET
- **请求参数**: 
  - `district`: 学生所在区
  - `type`: 学校类型
- **响应数据结构**: 保持不变

## 实现注意事项

### 1. 前端兼容性
- 确保NavBar在不同页面的显示效果一致
- 确保新增的学校卡片在没有数据时能够正常显示
- 确保样式调整后在不同设备上的显示效果一致

### 2. 性能优化
- 复用现有的API接口，避免重复请求
- 前端组件使用适当的缓存策略，提高页面加载速度

## 测试计划

### 1. 前端测试
- 测试NavBar的显示和返回功能
- 测试学校卡片的显示效果和样式一致性
- 测试"最近一年招生情况"的布局和样式
- 测试"录取分数线"的布局、顺序和样式
- 测试页面在不同设备上的响应式效果

## 变更影响范围

### 1. 影响模块
- 学校详情模块（前端）

### 2. 不影响模块
- 其他页面和功能模块
- 后端API接口（无需修改）
- 数据库结构（无需修改）

## 风险评估

### 1. 低风险
- 前端样式调整：仅调整布局和样式，不影响核心功能
- NavBar恢复：使用现有的NavBar组件，功能稳定

### 2. 注意事项
- 确保学校卡片的数据来源可靠，避免数据缺失导致前端显示异常
- 确保样式调整后在不同设备上的显示效果一致

## 交付物

### 1. 前端代码
- 修改后的`SchoolDetailPage.tsx`文件
- 修改后的`SchoolProfileSection.tsx`文件
- 修改后的`SchoolEnrollmentSection.tsx`文件
- 修改后的`SchoolScoresSection.tsx`文件

### 2. 文档
- 本需求变更文档
